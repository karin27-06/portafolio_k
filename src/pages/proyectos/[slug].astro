---
import Layout from "../../layouts/Layout.astro";
import Footer from "../../components/Footer.astro";
import { proyectos } from "../../data/proyectos";

export async function getStaticPaths() {
  return proyectos.map((proyecto) => ({
    params: { slug: proyecto.slug },
  }));
}

const { slug } = Astro.params;
const proyecto = proyectos.find((p) => p.slug === slug);

if (!proyecto) {
  throw new Error(`Proyecto no encontrado: ${slug}`);
}
---

<Layout title={proyecto.titulo}>
  <section class="project-detail fade-in-scroll">

    <!-- Imagen -->
<div class="carousel" data-carousel>
  <div class="carousel-track">
    {proyecto.imagenes.map((img) => (
      <img src={img} alt={proyecto.titulo} />
    ))}
  </div>

  <button class="nav prev">‹</button>
  <button class="nav next">›</button>
</div>

    <!-- Header -->
    <div class="header">
      <h1>{proyecto.titulo}</h1>
      <a href={proyecto.demo} target="_blank" class="btn btn-primary">
        Demo
      </a>
    </div>

    <p class="short-desc">{proyecto.descripcionCorta}</p>

    <div class="meta">
      <span>
        <i class="fa-solid fa-calendar-days"></i>
        {proyecto.fecha}
      </span>

      <span>
        <i class="fa-solid fa-hashtag"></i>
        {proyecto.tecnologias.length} tecnologías
      </span>
    </div>

    <h2>Stack Tecnológico</h2>
    <div class="tech-tags">
      {proyecto.tecnologias.map((tech) => (
        <span class="tag">{tech}</span>
      ))}
    </div>

    <h2>Descripción completa</h2>
    <p class="long-desc">{proyecto.descripcionCompleta}</p>

    <h2>Características principales</h2>
    <ul class="features">
      {proyecto.caracteristicas.map((item) => (
        <li>{item}</li>
      ))}
    </ul>

    <h2>Video del demo</h2>
    <div class="video-wrapper">
      <iframe src={proyecto.video} allowfullscreen></iframe>
    </div>

<div class="back-wrapper">
  <a href="/#proyectos" class="btn btn-outline back-btn">
    ← Regresar a inicio
  </a>
</div>

  </section>

  <Footer />
</Layout>
<script is:inline>
  document.querySelectorAll("[data-carousel]").forEach(carousel => {
    const track = carousel.querySelector(".carousel-track");
    const slides = track.children;
    let index = 0;
    let interval;

    const move = () => {
      track.style.transform = `translateX(-${index * 100}%)`;
    };

    const startAuto = () => {
      interval = setInterval(() => {
        index = (index + 1) % slides.length;
        move();
      }, 3500);
    };

    const resetAuto = () => {
      clearInterval(interval);
      startAuto();
    };

    carousel.querySelector(".next").onclick = () => {
      index = (index + 1) % slides.length;
      move();
      resetAuto();
    };

    carousel.querySelector(".prev").onclick = () => {
      index = (index - 1 + slides.length) % slides.length;
      move();
      resetAuto();
    };

    carousel.addEventListener("mouseenter", () => clearInterval(interval));
    carousel.addEventListener("mouseleave", startAuto);

    startAuto();
  });
</script>

<style>

.carousel {
  position: relative;
  max-width: 900px;
  margin: 0 auto 3rem;
  overflow: hidden;
  border-radius: 20px;
  aspect-ratio: 16 / 9;
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

.carousel-track {
  display: flex;
  transition: transform 0.7s ease-in-out;
}

.carousel-track img {
  min-width: 100%;
  width: 100%;
  height: 100%;
  object-fit: cover;
}


/* Flechas */
.nav {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background: rgba(0,0,0,.6);
  color: white;
  border: none;
  font-size: 2rem;
  padding: .4rem .7rem;
  cursor: pointer;
  z-index: 2;
  border-radius: 8px;
}

.prev { left: 12px; }
.next { right: 12px; }

.nav:hover {
  background: rgba(0,0,0,.85);
}

/* ===== CONTENEDOR ===== */
.project-detail {
  max-width: 960px;
  margin: auto;
  padding: 4rem 1.5rem;
  font-family: 'Inter', system-ui, sans-serif;
}

/* ===== IMAGEN ===== */
.hero-img {
  width: 100%;
  height: 420px;
  object-fit: cover;
  border-radius: 20px;
  margin-bottom: 2.5rem;
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

/* ===== HEADER ===== */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  flex-wrap: wrap;
}

.header h1 {
  font-size: 2.7rem; /* antes 2.3 */
  font-weight: 700;
  letter-spacing: -0.5px;
  color: #1f2937;
}

/* ===== DESCRIPCIÓN ===== */
.short-desc {
  margin: 1.8rem 0;
  font-size: 1.2rem;
  color: #4b5563;
  line-height: 1.8;
}

/* ===== META ===== */
.meta {
  display: flex;
  gap: 2.5rem;
  margin-bottom: 3.5rem;
  color: #6b7280;
  font-size: 0.95rem;
}

.meta span {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.meta i {
  color: #667eea;
  font-size: 1rem;
}

/* ===== TÍTULOS ===== */
.project-detail h2 {
  margin: 3.5rem 0 1.2rem;
  font-size: 1.9rem; /* más grandes */
  font-weight: 600;
  color: #111827;
}

.project-detail h2::after {
  content: "";
  display: block;
  width: 60px;
  height: 4px;
  margin-top: 0.5rem;
  background: linear-gradient(90deg, #667eea, #764ba2);
  border-radius: 2px;
}

/* ===== TAGS ===== */
.tech-tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.6rem;
}

.tag {
  background: #667eea;
  color: white;
  padding: 0.35rem 0.9rem;
  border-radius: 999px;
  font-size: 0.85rem;
  font-weight: 500;
}

/* ===== TEXTO ===== */
.long-desc {
  line-height: 1.9;
  font-size: 1.05rem;
  color: #4b5563;
}

.features {
  padding-left: 1.2rem;
}

.features li {
  margin-bottom: 0.7rem;
  font-size: 1.05rem;
  line-height: 1.7;
  color: #555;
}

/* ===== VIDEO ===== */
.video-wrapper {
  margin: 2.5rem 0;
  aspect-ratio: 16 / 9;
  border-radius: 20px;
  overflow: hidden;
  box-shadow: 0 20px 40px rgba(0,0,0,0.15);
}

.video-wrapper iframe {
  width: 100%;
  height: 100%;
  border: none;
}

.back-wrapper {
  display: flex;
  justify-content: center;
  margin-top: 3rem;
}

.back-btn {
  width: fit-content;
}

/* ===== DARK MODE ===== */
body.dark-mode .project-detail {
  background: #0f172a;
}

body.dark-mode .header h1,
body.dark-mode .project-detail h2 {
  color: #e5e7eb;
}

body.dark-mode .short-desc,
body.dark-mode .long-desc,
body.dark-mode .features li,
body.dark-mode .meta {
  color: #cbd5f5;
}

body.dark-mode .video-wrapper,
body.dark-mode .hero-img {
  box-shadow: 0 20px 40px rgba(0,0,0,0.6);
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .header h1 {
    font-size: 2.1rem;
  }
  .project-detail h2 {
    font-size: 1.6rem;
  }
  .short-desc {
    font-size: 1.1rem;
  }
  .meta {
    flex-direction: column;
    gap: 0.5rem;
  }

  .project-detail {
    padding: 3rem 1rem;
  }
  
}
/* ===== BOTONES ===== */
.btn {
  padding: 0.6rem 1.4rem;
  border-radius: 12px;
  font-size: 0.95rem;
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.3s ease;
}

/* Botón principal (Demo) */
.btn-primary {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: #fff;
  box-shadow: 0 10px 25px rgba(102, 126, 234, 0.35);
  animation: pulse 2.5s infinite;
}

.btn-primary:hover {
  transform: translateY(-3px);
  box-shadow: 0 15px 35px rgba(102, 126, 234, 0.5);
}

/* Botón secundario */
.btn-outline {
  background: transparent;
  border: 1.5px solid #667eea;
  color: #667eea;
}

.btn-outline:hover {
  background: #667eea;
  color: #fff;
  transform: translateY(-2px);
}

/* Botón icono (GitHub si lo agregas aquí luego) */
.btn-icon {
  width: 44px;
  height: 44px;
  padding: 0;
  justify-content: center;
  font-size: 1.2rem;
  background: #111827;
  color: #fff;
  border-radius: 50%;
}

.btn-icon:hover {
  background: #000;
  transform: scale(1.1);
}
@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(102,126,234,0.5); }
  70% { box-shadow: 0 0 0 12px rgba(102,126,234,0); }
  100% { box-shadow: 0 0 0 0 rgba(102,126,234,0); }
}
</style>
